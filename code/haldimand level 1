{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "d7d5e654",
   "metadata": {},
   "outputs": [],
   "source": [
    "#import necessary packages\n",
    "import platform\n",
    "import os\n",
    "import sys\n",
    "import time\n",
    "#for managing the data\n",
    "import pandas as pd\n",
    "\n",
    "#install !pip install webdriver-manager\n",
    "#webdrivers\n",
    "from selenium import webdriver\n",
    "from selenium.webdriver.chrome.service import Service as ChromeService\n",
    "from webdriver_manager.chrome import ChromeDriverManager\n",
    "from selenium.webdriver.common.by import By\n",
    "\n",
    "from bs4 import BeautifulSoup"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "3df70c99",
   "metadata": {},
   "outputs": [],
   "source": [
    "#data prefix for output data\n",
    "yearmonth = \"202404\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "d6997359",
   "metadata": {},
   "outputs": [],
   "source": [
    "#open web driver\n",
    "driver = webdriver.Chrome(service=ChromeService(ChromeDriverManager().install()))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "c02b01a0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#url\n",
    "base_url_list = \\\n",
    "[\n",
    "    ['Food Safety',\"https://inspectourcommunity.hnhss.ca/Portal/FoodSafety/Table\", ['Facility Name','Facility Type','Last Inspection Date','Site Address']],\n",
    "    ['Recreational Camps',\"https://inspectourcommunity.hnhss.ca/Portal/RecreationalCamps/Table\", ['Facility Name','Facility Type','Last Inspection Date','Site Address']],\n",
    "    ['Infection Control',\"https://inspectourcommunity.hnhss.ca/Portal/InfectionControl/Table\", ['Facility Name','Facility Type','Last Inspection Date','Site Address']],\n",
    "    ['Recreational Water',\"https://inspectourcommunity.hnhss.ca/Portal/RecreationalWater/Table\",['Facility Name','Facility Type','Last Inspection Date','Site Address']],\n",
    "    ['Drinking Water',\"https://inspectourcommunity.hnhss.ca/Portal/DrinkingWater/Table\",['Facility Name','Facility Type','Last Inspection Date','Site Address']],\n",
    "    ['Closures/Charges',\"https://inspectourcommunity.hnhss.ca/Portal/Enforcements\",['Facility Name','Site Address','Type','Offense','Outcome','Offense Date','Resolved Date']],\n",
    "]\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2627da7a",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "1247f93f",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n",
      "C:\\Users\\nanil\\AppData\\Local\\Temp\\ipykernel_23096\\4001557055.py:42: FutureWarning: Passing literal html to 'read_html' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.\n",
      "  df = pd.read_html(driver.page_source)\n"
     ]
    }
   ],
   "source": [
    "#place holder for final dataframe list\n",
    "df_list = []\n",
    "\n",
    "for u in base_url_list:\n",
    "    category = u[0]\n",
    "    base_url = u[1]\n",
    "    columns  = u[2]\n",
    "\n",
    "    #load main landing page\n",
    "    driver.get(base_url)\n",
    "    \n",
    "    try:\n",
    "        #find disclaimer button\n",
    "        disclamer_btn = driver.find_element(by='name', value=\"AcceptDisclaimerButton\")\n",
    "\n",
    "        #click the disclaimer button to move to the data page\n",
    "        disclamer_btn.click()\n",
    "    except:\n",
    "        pass\n",
    "    \n",
    "    # We will loop through until there's no next page button on the webpage\n",
    "    #find next page button\n",
    "    last_page = False\n",
    "\n",
    "    while last_page==False:\n",
    "        try:\n",
    "            next_btn = driver.find_element(By.CLASS_NAME, value=\"next-page-link\")\n",
    "        except:\n",
    "            last_page = True\n",
    "\n",
    "\n",
    "        #place holder for extracted data\n",
    "        data_url_list = []\n",
    "\n",
    "        #locate each table rows\n",
    "        data_rows = driver.find_elements(By.CLASS_NAME, value=\"hovereffect\")\n",
    "\n",
    "        for row in data_rows:\n",
    "            data_url_list.append( row.get_attribute(\"onclick\") )\n",
    "\n",
    "        #convert html table into dataframe\n",
    "        df = pd.read_html(driver.page_source)\n",
    "        df = df[0]\n",
    "        \n",
    "\n",
    "        #rename columns for clean up\n",
    "        df.columns = columns\n",
    "        \n",
    "        #append url column and category column\n",
    "        df['url'] = data_url_list\n",
    "        df['category'] = category\n",
    "\n",
    "        #put aside resulting table\n",
    "        df_list.append(df)\n",
    "\n",
    "        if last_page==True:\n",
    "            break\n",
    "        #move to the next page\n",
    "        next_btn.click()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "ceaeaffe",
   "metadata": {},
   "outputs": [],
   "source": [
    "final_df = pd.concat(df_list)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "f1bce748",
   "metadata": {},
   "outputs": [],
   "source": [
    "final_df.to_csv( \"../data/{}_1st_table.csv\".format(yearmonth) )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "e568037c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#close webdriver\n",
    "try:\n",
    "    driver.close()\n",
    "except:\n",
    "    pass"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "9280a52d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Facility Name</th>\n",
       "      <th>Facility Type</th>\n",
       "      <th>Last Inspection Date</th>\n",
       "      <th>Site Address</th>\n",
       "      <th>url</th>\n",
       "      <th>category</th>\n",
       "      <th>Type</th>\n",
       "      <th>Offense</th>\n",
       "      <th>Outcome</th>\n",
       "      <th>Offense Date</th>\n",
       "      <th>Resolved Date</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1/4 Mile Diner</td>\n",
       "      <td>Mobile Preparation Premises</td>\n",
       "      <td>30-Jun-2023</td>\n",
       "      <td>Toronto Motorsports Park-180 Kohler Road Cayug...</td>\n",
       "      <td>location.href = '/Portal/Facility/Details/c940...</td>\n",
       "      <td>Food Safety</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2 Main West Variety &amp; Gas</td>\n",
       "      <td>Convenience / Variety</td>\n",
       "      <td>14-Mar-2024</td>\n",
       "      <td>2 Main Avenue West, P.O. Box 83 Fisherville ON...</td>\n",
       "      <td>location.href = '/Portal/Facility/Details/74ed...</td>\n",
       "      <td>Food Safety</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>211 Main</td>\n",
       "      <td>Restaurant</td>\n",
       "      <td>26-Jan-2024</td>\n",
       "      <td>211 Main St Port Dover ON N0A 1N0</td>\n",
       "      <td>location.href = '/Portal/Facility/Details/60ec...</td>\n",
       "      <td>Food Safety</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4 Seasons Farm Shop</td>\n",
       "      <td>Convenience / Variety</td>\n",
       "      <td>01-Dec-2023</td>\n",
       "      <td>691 Norfolk St S Simcoe ON N3Y 4K1</td>\n",
       "      <td>location.href = '/Portal/Facility/Details/6d3e...</td>\n",
       "      <td>Food Safety</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4280 Pho + Gourmet Take-out</td>\n",
       "      <td>Food Take Out</td>\n",
       "      <td>12-Jan-2024</td>\n",
       "      <td>C-318 Main St PO Box 329 Port Dover ON N0A 1N0</td>\n",
       "      <td>location.href = '/Portal/Facility/Details/d543...</td>\n",
       "      <td>Food Safety</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>Windecker Woods</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>215 Windecker Road Cayuga ON N0A 1E0</td>\n",
       "      <td>location.href = '/Portal/Facility/Details/9ffd...</td>\n",
       "      <td>Closures/Charges</td>\n",
       "      <td>Section 13 Order</td>\n",
       "      <td>Fail to provide hot and cold running water in ...</td>\n",
       "      <td>Facility Closed</td>\n",
       "      <td>04-Jul-2023</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>Windecker Woods</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>215 Windecker Road Cayuga ON N0A 1E0</td>\n",
       "      <td>location.href = '/Portal/Facility/Details/9ffd...</td>\n",
       "      <td>Closures/Charges</td>\n",
       "      <td>Section 13 Order</td>\n",
       "      <td>Fail to protect against the entry of pests</td>\n",
       "      <td>Facility Closed</td>\n",
       "      <td>04-Jul-2023</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>Woodside Greens Golf Club - Clubhouse</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>847 Charlotteville Rd 10 Simcoe ON N3Y 4J9</td>\n",
       "      <td>location.href = '/Portal/Facility/Details/275e...</td>\n",
       "      <td>Closures/Charges</td>\n",
       "      <td>Section 13 Order</td>\n",
       "      <td>Fail to provide hot and cold running water in ...</td>\n",
       "      <td>Facility Re-Opened</td>\n",
       "      <td>08-May-2023</td>\n",
       "      <td>10-May-2023</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>Woodside Greens Golf Club - Clubhouse</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>847 Charlotteville Rd 10 Simcoe ON N3Y 4J9</td>\n",
       "      <td>location.href = '/Portal/Facility/Details/275e...</td>\n",
       "      <td>Closures/Charges</td>\n",
       "      <td>Section 13 Order</td>\n",
       "      <td>Fail to provide food premise with adequate pot...</td>\n",
       "      <td>Facility Re-Opened</td>\n",
       "      <td>08-May-2023</td>\n",
       "      <td>10-May-2023</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>Yu's Restaurant</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>B-63 King St Delhi ON N4B 1X7</td>\n",
       "      <td>location.href = '/Portal/Facility/Details/3145...</td>\n",
       "      <td>Closures/Charges</td>\n",
       "      <td>Ticket</td>\n",
       "      <td>Fail to ensure equipment surface cleaned as ne...</td>\n",
       "      <td>Ticket Served</td>\n",
       "      <td>02-Apr-2024</td>\n",
       "      <td>02-Apr-2024</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1502 rows × 11 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                            Facility Name                Facility Type  \\\n",
       "0                          1/4 Mile Diner  Mobile Preparation Premises   \n",
       "1               2 Main West Variety & Gas        Convenience / Variety   \n",
       "2                                211 Main                   Restaurant   \n",
       "3                     4 Seasons Farm Shop        Convenience / Variety   \n",
       "4             4280 Pho + Gourmet Take-out                Food Take Out   \n",
       "..                                    ...                          ...   \n",
       "12                        Windecker Woods                          NaN   \n",
       "13                        Windecker Woods                          NaN   \n",
       "14  Woodside Greens Golf Club - Clubhouse                          NaN   \n",
       "15  Woodside Greens Golf Club - Clubhouse                          NaN   \n",
       "16                        Yu's Restaurant                          NaN   \n",
       "\n",
       "   Last Inspection Date                                       Site Address  \\\n",
       "0           30-Jun-2023  Toronto Motorsports Park-180 Kohler Road Cayug...   \n",
       "1           14-Mar-2024  2 Main Avenue West, P.O. Box 83 Fisherville ON...   \n",
       "2           26-Jan-2024                  211 Main St Port Dover ON N0A 1N0   \n",
       "3           01-Dec-2023                 691 Norfolk St S Simcoe ON N3Y 4K1   \n",
       "4           12-Jan-2024     C-318 Main St PO Box 329 Port Dover ON N0A 1N0   \n",
       "..                  ...                                                ...   \n",
       "12                  NaN               215 Windecker Road Cayuga ON N0A 1E0   \n",
       "13                  NaN               215 Windecker Road Cayuga ON N0A 1E0   \n",
       "14                  NaN         847 Charlotteville Rd 10 Simcoe ON N3Y 4J9   \n",
       "15                  NaN         847 Charlotteville Rd 10 Simcoe ON N3Y 4J9   \n",
       "16                  NaN                      B-63 King St Delhi ON N4B 1X7   \n",
       "\n",
       "                                                  url          category  \\\n",
       "0   location.href = '/Portal/Facility/Details/c940...       Food Safety   \n",
       "1   location.href = '/Portal/Facility/Details/74ed...       Food Safety   \n",
       "2   location.href = '/Portal/Facility/Details/60ec...       Food Safety   \n",
       "3   location.href = '/Portal/Facility/Details/6d3e...       Food Safety   \n",
       "4   location.href = '/Portal/Facility/Details/d543...       Food Safety   \n",
       "..                                                ...               ...   \n",
       "12  location.href = '/Portal/Facility/Details/9ffd...  Closures/Charges   \n",
       "13  location.href = '/Portal/Facility/Details/9ffd...  Closures/Charges   \n",
       "14  location.href = '/Portal/Facility/Details/275e...  Closures/Charges   \n",
       "15  location.href = '/Portal/Facility/Details/275e...  Closures/Charges   \n",
       "16  location.href = '/Portal/Facility/Details/3145...  Closures/Charges   \n",
       "\n",
       "                Type                                            Offense  \\\n",
       "0                NaN                                                NaN   \n",
       "1                NaN                                                NaN   \n",
       "2                NaN                                                NaN   \n",
       "3                NaN                                                NaN   \n",
       "4                NaN                                                NaN   \n",
       "..               ...                                                ...   \n",
       "12  Section 13 Order  Fail to provide hot and cold running water in ...   \n",
       "13  Section 13 Order         Fail to protect against the entry of pests   \n",
       "14  Section 13 Order  Fail to provide hot and cold running water in ...   \n",
       "15  Section 13 Order  Fail to provide food premise with adequate pot...   \n",
       "16            Ticket  Fail to ensure equipment surface cleaned as ne...   \n",
       "\n",
       "               Outcome Offense Date Resolved Date  \n",
       "0                  NaN          NaN           NaN  \n",
       "1                  NaN          NaN           NaN  \n",
       "2                  NaN          NaN           NaN  \n",
       "3                  NaN          NaN           NaN  \n",
       "4                  NaN          NaN           NaN  \n",
       "..                 ...          ...           ...  \n",
       "12     Facility Closed  04-Jul-2023           NaN  \n",
       "13     Facility Closed  04-Jul-2023           NaN  \n",
       "14  Facility Re-Opened  08-May-2023   10-May-2023  \n",
       "15  Facility Re-Opened  08-May-2023   10-May-2023  \n",
       "16       Ticket Served  02-Apr-2024   02-Apr-2024  \n",
       "\n",
       "[1502 rows x 11 columns]"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4053b95a",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
